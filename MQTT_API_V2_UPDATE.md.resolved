# MQTT API V2.0 - RECENT UPDATES GUIDE (Jan 2026)
This document provides the definitive MQTT contract for the latest 5 updates.
**Status:** PROD-READY | **Version:** 2.0.1

## 1. AGENT VOICE CONTROL (New)
Dynamic voice selection for Gemini 12-2025 Native Audio model.

### 1.1 List Available Voices
**Topic:** `agent/voice/list`  
**Payload:** [GET](file:///c:/Users/ASUS/Downloads/genai/unified_app.py#729-738) (or empty)  
**Description:** Request list of all available voices.

### 1.2 Voice List Response
**Topic:** `agent/voice/list/response`  
**Format:** JSON
```json
{
  "timestamp": "ISO8601",
  "status": "success",
  "current_voice": "Puck",
  "voices": [
    {"name": "Puck", "style": "Friendly & Conversational (Default)"},
    {"name": "Charon", "style": "Deep & Authoritative"},
    {"name": "Fenrir", "style": "Warm & Approachable"},
    ...
  ]
}
```

### 1.3 Set Agent Voice
**Topic:** `agent/voice/set`  
**Format:** JSON
```json
{
  "voice": "Charon"  // Case-insensitive name
}
```
**Description:** Updates the preferred voice. Applies on next Agent startup/restart.

### 1.4 Voice Status
**Topic:** `agent/voice/status`  
**Format:** JSON
```json
{
  "status": "success",
  "message": "Voice set to Charon. Restart agent to apply.",
  "voice": "Charon"
}
```

---

## 2. ADVANCED MEMORY SEARCH (New)
Search memory vector store for specific activities (e.g., "coding", "meeting").

### 2.1 Search Activities
**Topic:** `memory/activity/search`  
**Format:** JSON
```json
{
  "query": "coding python",  // Optional text query
  "activity_type": "coding", // Optional filter
  "days_back": 7,            // Look back 7 days
  "limit": 10
}
```

### 2.2 Activity Response
**Topic:** `memory/activity/response`  
**Format:** JSON Array (List of Activities)
```json
[
  {
    "id": "uuid",
    "timestamp": "2026-01-10T14:00:00",
    "summary": "Worked on MQTT implementation",
    "activity_type": "coding",
    "facts": ["fixed bug X", "deployed Y"]
  },
  ...
]
```

---

## 3. MEMORY STATS (New)
Get detailed statistics about memory usage and activity breakdown.

### 3.1 Request Stats
**Topic:** `memory/stats/request`  
**Payload:** [GET](file:///c:/Users/ASUS/Downloads/genai/unified_app.py#729-738)

### 3.2 Stats Response
**Topic:** `memory/stats/response`  
**Format:** JSON
```json
{
  "total_activities": 150,
  "last_activity": "2026-01-11T...",
  "by_type": {
    "coding": 50,
    "meeting": 20,
    "general": 80
  },
  "memories": {
    "total": 500,
    "by_type": {
      "episodic": 300,
      "semantic": 200
    }
  }
}
```

---

## 4. BASE MEMORY (Categorized Update)
The standard memory payload has been upgraded to include auto-categorization by the LLM.

### 4.1 Request Base Memory
**Topic:** `memory/base/request`  
**Payload:** [GET](file:///c:/Users/ASUS/Downloads/genai/unified_app.py#729-738)

### 4.2 Categorized Response
**Topic:** `memory/base/response`  
**Format:** JSON
```json
{
  "status": "success",
  "format": "categorized",
  "data": {
    "identities": [{"text": "User is a developer", "confidence": 0.9}],
    "deep_facts": [{"text": "Prefers Python over JS", "confidence": 0.8}],
    "preferences": [{"text": "Dark mode UI", "confidence": 0.95}],
    
    // NEW: Detailed Sub-Categories
    "categorized": {
      "identity": {
         "professional": ["Senior Python Developer"],
         "personal": ["Lives in Seattle"]
      },
      "preference": {
         "tools": ["VS Code", "Terminal"],
         "learning_style": ["Hands-on"]
      },
      "deep_fact": {
         "goals": ["Build AGI"]
      }
    }
  }
}
```

---

## 5. FLASHCARD ARTIFACT (Format Update)
Flashcards are now Fact-Based (Term/Definition) rather than Q&A.

**Topic:** `gacor/1` (Note Result)  
**Format:** JSON inside `artifacts.flashcards`
```json
[
  {
    "front": "Photosynthesis Equation", 
    "back": "6CO2 + 6H2O -> C6H12O6 + 6O2"
  },
  {
    "front": "Metcalfe's Law", 
    "back": "Value of network ~ n^2"
  }
]
```

---

## 6. REACTIVE HEARTBEAT
**Topic:** `alex/dashboard/state/request` (Publish to GET state)  
**Response:** `alex/dashboard/state` (Contains `"status": "idle"`, `"mode": "..."`)
**Note:** Proactive 1s heartbeat is REMOVED. Frontend must poll or React to state changes.

---

## 7. GLOBAL AUTH (Behavior Update)
**Commands:** `AUTH:GMAIL`, `AUTH:CALENDAR`, `AUTH:DRIVE`
**Behavior:** Triggering ANY auth command now requests **ALL** scopes (Gmail, Calendar, Drive, Classroom).
**Frontend Action:** Check `http://localhost:8032/health` -> `auth_status` to confirm readiness.
